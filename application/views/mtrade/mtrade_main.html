<script>
(function($){
    function init(){
	initTree();
	initTabs();
    }
    init();
    function initTree(){
	App.loadModule('page/company/tree',{inline:true,clickselect:true},'mCtreeInline',/(Ctree|page_company_tree)([^\w]|_)/g,"mCtreeInline$2").progress(function(status,company){
	    if( status==='select' ){
		App.user.pcompSelect(company);
	    }
	    if( status==='deleted' && company==='company' || status==='reset' ){
		App.user.pcompSelect({company_id:0});
		App.pcomp={};
	    }
	});
    }
    function initTabs(){
        App.isellTabs('#mtrade_main_tabs',[
            {title:"Документы",url:"page/mtrade/document_list.html"},
            {title:"Взаиморасчет",url:"page/mtrade/payments.html",class:'tab_pcomp_only'},
            {title:"Настройки",url:"page/company/prefs.html",class:'tab_pcomp_only'},
            {title:"Реквизиты",url:"page/mtrade/details.html",class:'tab_pcomp_only'}
        ]);
        App.Topic('passiveCompanySelected').subscribe(function(){
            $('#mtrade_main_tabs .tab_pcomp_only').removeClass('isell-tabs-disabled');
        });
        App.Topic('passiveCompanyReset').subscribe(function(){
            $('#mtrade_main_tabs .tab_pcomp_only').addClass('isell-tabs-disabled');
        });        
    }
})(jQuery);
</script>
<style>
    .mtrade_grid{
        display: grid;
        gap:2px;
        grid-template-columns: min-content min-content;
    }
</style>
<div class="mtrade_grid">
    <div>
        <div id="mCtreeInline" class="transp60"></div>
    </div>
    <div id="mtrade_main_tabs"></div>
</div>
